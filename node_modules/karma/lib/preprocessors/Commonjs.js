var log = require('../logger').create('preprocess.commonjs');

var CommonJS = function(content, file, basePath, done) {
  log.debug('Processing "%s".', file.originalPath);

	var output = "(function(require, module, exports) {" +
			content +
		"}(function(dependency) {" +
		"  dump('REQUIRED FROM " + file.originalPath + ": ' + dependency);" +
		"}, {}, {}))";

	done(output);

//  file.path = file.originalPath + '-compiled.js';
//
//  var processed = null;
//  try {
//    processed = coffee.compile(content, {bare: true});
//  } catch (e) {
//    log.error('%s\n  at %s', e.message, file.originalPath);
//  }
};

// PUBLISH
module.exports = CommonJS;
